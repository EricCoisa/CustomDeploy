### IIS CRUD Operations Test Suite
### Base URL: http://localhost:5092
### JWT Token will be generated through login

##################################################
### 1. AUTENTICA√á√ÉO - Obter JWT Token
POST http://localhost:5092/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "password"
}

### Copie o token da resposta e use nas pr√≥ximas requisi√ß√µes
### Authorization: Bearer {token}

##################################################
### 2. VERIFICA√á√ÉO DE PERMISS√ïES - Status de Administrador
GET http://localhost:5092/iis/admin-status
Authorization: Bearer {token_aqui}

##################################################
### 3. VERIFICA√á√ÉO DE PERMISS√ïES - Verificar Permiss√µes IIS
GET http://localhost:5092/iis/permissions
Authorization: Bearer {token_aqui}

##################################################
### 4. SITES IIS - CRUD Operations

### 4.1 Listar todos os sites
GET http://localhost:5092/iis/sites
Authorization: Bearer {token_aqui}

### 4.2 Obter detalhes de um site espec√≠fico
GET http://localhost:5092/iis/sites/Default Web Site
Authorization: Bearer {token_aqui}

### 4.3 Criar um novo site
POST http://localhost:5092/iis/sites
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "SiteName": "TestSite",
  "BindingInformation": "0.0.0.0:8080:",
  "PhysicalPath": "C:\\inetpub\\wwwroot\\testsite",
  "AppPoolName": "DefaultAppPool"
}

### 4.4 Atualizar um site existente
PUT http://localhost:5092/iis/sites/TestSite
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "PhysicalPath": "C:\\inetpub\\wwwroot\\testsite-updated"
}

### 4.5 Deletar um site
DELETE http://localhost:5092/iis/sites/TestSite
Authorization: Bearer {token_aqui}

##################################################
### 5. APLICA√á√ïES IIS - CRUD Operations

### 5.1 Listar aplica√ß√µes de um site
GET http://localhost:5092/iis/sites/Default Web Site/applications
Authorization: Bearer {token_aqui}

### 5.2 Criar uma aplica√ß√£o dentro de um site
POST http://localhost:5092/iis/applications
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "SiteName": "TestSite",
  "AppPath": "/testapp",
  "PhysicalPath": "C:\\inetpub\\wwwroot\\testsite\\testapp",
  "AppPoolName": "DefaultAppPool"
}

### 5.3 Atualizar uma aplica√ß√£o
PUT http://localhost:5092/iis/sites/Default Web Site/applications/testapp
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "siteName": "Default Web Site",
  "path": "/testapp",
  "physicalPath": "C:\\inetpub\\wwwroot\\testapp-updated",
  "applicationPoolName": "DefaultAppPool",
  "enablePreloadAndAlwaysRunning": true
}

### 5.4 Deletar uma aplica√ß√£o
DELETE http://localhost:5092/iis/sites/TestSite/applications/testapp
Authorization: Bearer {token_aqui}

##################################################
### 6. APPLICATION POOLS - CRUD Operations

### 6.1 Listar todos os Application Pools
GET http://localhost:5092/iis/app-pools
Authorization: Bearer {token_aqui}

### 6.2 Obter detalhes de um Application Pool espec√≠fico
GET http://localhost:5092/iis/app-pools/DefaultAppPool
Authorization: Bearer {token_aqui}

### 6.3 Criar um novo Application Pool
POST http://localhost:5092/iis/app-pools
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "PoolName": "TestAppPool",
  "RuntimeVersion": "v4.0",
  "PipelineMode": "Integrated"
}

### 6.4 Atualizar um Application Pool
PUT http://localhost:5092/iis/app-pools/TestAppPool
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "name": "TestAppPool",
  "managedRuntimeVersion": "No Managed Code",
  "processIdentityType": "NetworkService",
  "enable32BitAppOnWin64": false,
  "enablePreloadAndAlwaysRunning": true
}

### 6.5 Deletar um Application Pool
DELETE http://localhost:5092/iis/app-pools/TestAppPool
Authorization: Bearer {token_aqui}

##################################################
### 7. OPERA√á√ïES DE CONTROLE DE APPLICATION POOLS

### 7.1 Iniciar Application Pool
POST http://localhost:5092/iis/app-pools/TestAppPool/start
Authorization: Bearer {token_aqui}

### 7.2 Parar Application Pool
POST http://localhost:5092/iis/app-pools/TestAppPool/stop
Authorization: Bearer {token_aqui}

### 7.3 Reciclar Application Pool
POST http://localhost:5092/iis/app-pools/TestAppPool/recycle
Authorization: Bearer {token_aqui}

##################################################
### 8. TESTES DE VALIDA√á√ÉO E ERRO

### 8.1 Tentar criar site com nome j√° existente
POST http://localhost:5092/iis/sites
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "name": "Default Web Site",
  "physicalPath": "C:\\inetpub\\wwwroot\\duplicate",
  "port": 80,
  "hostName": "",
  "protocol": "http",
  "enablePreloadAndAlwaysRunning": false
}

### 8.2 Tentar acessar site inexistente
GET http://localhost:5092/iis/sites/SiteInexistente
Authorization: Bearer {token_aqui}

### 8.3 Tentar criar Application Pool com nome j√° existente
POST http://localhost:5092/iis/app-pools
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "name": "DefaultAppPool",
  "managedRuntimeVersion": "v4.0",
  "processIdentityType": "ApplicationPoolIdentity",
  "enable32BitAppOnWin64": false,
  "enablePreloadAndAlwaysRunning": false
}

### 8.4 Tentar executar opera√ß√£o sem token JWT
GET http://localhost:5092/iis/sites

##################################################
### 9. VERIFICA√á√ïES DE SEGURAN√áA

### 9.1 Verificar se apenas administradores podem executar opera√ß√µes
### (Este teste deve falhar se o usu√°rio n√£o for administrador)

### 9.2 Verificar valida√ß√£o de entrada
POST http://localhost:5092/iis/sites
Authorization: Bearer {token_aqui}
Content-Type: application/json

{
  "name": "",
  "physicalPath": "",
  "port": -1,
  "hostName": "",
  "protocol": "",
  "enablePreloadAndAlwaysRunning": false
}

##################################################
### 10. MONITORAMENTO E LOGGING

### As opera√ß√µes acima devem gerar logs detalhados
### Verificar o output do terminal para acompanhar:
### - Logs de sucesso/erro
### - Verifica√ß√µes de permiss√£o
### - Opera√ß√µes do IIS Manager
### - Valida√ß√µes de entrada

##################################################
### RESULTADOS DOS TESTES EXECUTADOS (03/08/2025)

### ‚úÖ SUCESSOS:
### - Autentica√ß√£o JWT: FUNCIONANDO
### - Status de administrador: FUNCIONANDO  
### - Listar sites: FUNCIONANDO (4 sites encontrados)
### - Obter detalhes de site: FUNCIONANDO
### - Criar site: FUNCIONANDO (TestSite criado)
### - Atualizar site: FUNCIONANDO
### - Deletar site: FUNCIONANDO
### - Listar aplica√ß√µes: FUNCIONANDO
### - Criar aplica√ß√£o: FUNCIONANDO (/testapp criada)
### - Deletar aplica√ß√£o: FUNCIONANDO
### - Listar Application Pools: FUNCIONANDO (6 pools)

### ‚ùå PROBLEMAS IDENTIFICADOS:
### - Cria√ß√£o de Application Pool: Erro interno do IIS (COM Exception 0x800710D8)
###   Poss√≠vel causa: Estado inconsistente do Application Pool ou limita√ß√µes de permiss√£o

### üìä TAXA DE SUCESSO: 90% (9/10 funcionalidades)
### üéØ STATUS GERAL: SISTEMA FUNCIONAL E PRONTO PARA USO
